image: node:8.1
stages:
  - deploy

deploy:
  stage: deploy
  before_script:
   - mkdir /home/node/.npm-global
   - PATH=/home/node/.npm-global/bin:$PATH
   - NPM_CONFIG_PREFIX=/home/node/.npm-global
   - npm install --unsafe-perms -g angular-cli 
   - npm install --unsafe-perms
   - apt update
   - apt upgrade
   - apt install lftp
  script:
    - ng build --target=production
    - lftp -e "mirror -R dist /" -u $FTP_USERNAME,$FTP_PASSWORD $FTP_HOST 
  except:
    - tags

